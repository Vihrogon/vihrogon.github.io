<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Snake</title>
<style>
  html, body {
    position: relative;
    margin: 0px;
    height: 100%;
    //overflow: hidden;
  }
  canvas {
    margin: 0px;
  }
  button {
    font-size: 4em;
  }
</style>
<script>
window.onload = function (){
  
  window.addEventListener('keydown', function (){
    //does not allow the snake to move backwards or twice per interval
    if (event.key == 'ArrowUp' && dir != 'down' && canMove){
      canMove = false;
      dir = 'up';
	  moveX = 0;
      moveY = -1;
	} else if (event.key == 'ArrowDown' && dir != 'up' && canMove){
      canMove = false;
      dir = 'down';
      moveX = 0;
      moveY = 1;
    } else if (event.key == 'ArrowLeft' && dir != 'right' && canMove){
      canMove = false;
      dir = 'left';
      moveX = -1;
      moveY = 0;
    } else if (event.key == 'ArrowRight' && dir != 'left' && canMove){
      canMove = false;
      dir = 'right';
      moveX = 1;
      moveY = 0;
    }
  });
  
  const time = window.setInterval(function (){
    snake.move();
    draw();
  }, 100);
  const canvas = document.createElement('canvas');
  const ctx = canvas.getContext('2d');
  canvas.width = 360;
  canvas.height = 560;
  document.body.appendChild(canvas);
  //draws the keys
  ctx.beginPath();
  ctx.font = "135px Arial";
  ctx.strokeRect(130, 360, 100, 100);
  ctx.fillText('U', 130, 460);
  ctx.strokeRect(30, 410, 100, 100);
  ctx.fillText('L', 30, 510);
  ctx.strokeRect(230, 410, 100, 100);
  ctx.fillText('R', 230, 510);
  ctx.strokeRect(130, 460, 100, 100);
  ctx.fillText('D', 130, 560);
  ctx.closePath();
  //add onclick event for movement on devices without physical keyboard
  canvas.addEventListener('mousedown', function (){
    if (event.clientX > 130 && event.clientX < 230 && event.clientY > 360 && event.clientY < 460 && dir != 'down' && canMove){
      canMove = false;
      dir = 'up';
	  moveX = 0;
      moveY = -1;
    }
    if (event.clientX > 30 && event.clientX < 130 && event.clientY > 410 && event.clientY < 510 && dir != 'right' && canMove){
      canMove = false;
      dir = 'left';
	  moveX = -1;
      moveY = 0;
    }
    if (event.clientX > 230 && event.clientX < 330 && event.clientY > 410 && event.clientY < 510 && dir != 'left' && canMove){
      canMove = false;
      dir = 'right';
	  moveX = 1;
      moveY = 0;
    }
    if (event.clientX > 130 && event.clientX < 230 && event.clientY > 460 && event.clientY < 560 && dir != 'up' && canMove){
      canMove = false;
      dir = 'down';
	  moveX = 0;
      moveY = 1;
    }
  });
  
  var canMove = true;
  var dir = 'up';
  var moveX = 0;
  var moveY = -1;
  var apple = {
    x: rr(0, 29),
    y: rr(0, 29)
  };
  var snake = {
    body: [{x: 16, y: 17}, {x: 16, y: 18}, {x: 16, y: 19}],
    head: {x: 16, y: 16},
    move: function (){
      
      canMove = true;
      
      this.body.unshift({x: this.head.x, y: this.head.y});
      this.body.pop();
      
      this.head.x += moveX;
      this.head.y += moveY;
      //checks for collision with the edge
      if (this.head.x < 0){
        this.head.x = 29;
      } else if (this.head.x > 29){
        this.head.x = 0;
      } else if (this.head.y < 0){
        this.head.y = 29;
      } else if (this.head.y > 29){
        this.head.y = 0;
      }
      //checks for collision between the head and the body
      for (var n = 0; n < this.body.length; n++){
        if (this.head.x == this.body[n].x && this.head.y == this.body[n].y){
          this.body.splice(n, this.body.length);
        }
      }
      //checks for collision between the head and the apple
      if (this.head.x == apple.x && this.head.y == apple.y){
        this.body.push({x: this.head.x,y: this.head.y});
        apple.x = rr(0, 29);
        apple.y = rr(0, 29);
      }
    }
  };
  
  function draw (){
    //draw the background
    ctx.beginPath();
    ctx.fillStyle = 'black';
    ctx.fillRect(0, 0, 360, 360);
    ctx.closePath();
    //draw the apple
    ctx.beginPath();
    ctx.rect(apple.x * 12, apple.y * 12, 10, 10);
    ctx.fillStyle = 'red';
    ctx.fill();
    ctx.closePath();
    //draw the snakes head
    ctx.beginPath();
    ctx.rect(snake.head.x * 12, snake.head.y * 12, 10, 10);
    ctx.fillStyle = 'darkgreen';
    ctx.fill();
    ctx.closePath();
    //draw the snakes body
    for ( var n = 0; n < snake.body.length; n++){
      ctx.beginPath();
      ctx.rect(snake.body[n].x * 12, snake.body[n].y * 12, 10, 10);
      ctx.fillStyle = 'green';
      ctx.fill();
      ctx.closePath();
    }
  }
  //returns a random number in the range of and including n1 and n2 and (if given) excluding n3
  function rr(n1, n2, n3){
    var num = Math.floor(Math.random() * (n2 - n1 + 1) + n1);
    if (arguments.length == 3 && num == n3){
      return this.rr(n1, n2, n3);
    }else {
      return num;
    }
  }
  //sets the stage before the game starts
  draw();
}
</script>
</head>
<body>

</body>
</html> 